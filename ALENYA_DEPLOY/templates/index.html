<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALENYA - El Agente IA Más Avanzado del Mundo | MELANO INC</title>
    <meta name="description" content="ALENYA: Tu asistente IA especializada en inversiones, ventas y real estate. Automatización inteligente para maximizar ROI.">
    <meta name="keywords" content="IA, inversiones, ventas, real estate, automatización, ROI, MELANO INC">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .alenya-gradient {
            background: linear-gradient(135deg, #ff6b6b 0%, #4ecdc4 50%, #45b7d1 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .chat-container {
            height: 500px;
            background: linear-gradient(145deg, #f8fafc, #e2e8f0);
        }
        
        .message-user {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .message-alenya {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            color: white;
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .hover-scale {
            transition: transform 0.3s ease;
        }
        
        .hover-scale:hover {
            transform: scale(1.05);
        }
        
        .glassmorphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    
    <!-- Header -->
    <header class="gradient-bg text-white shadow-2xl">
        <div class="container mx-auto px-6 py-8">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center">
                        <i class="fas fa-robot text-2xl text-purple-600"></i>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold">ALENYA</h1>
                        <p class="text-purple-200">El Agente IA Más Avanzado del Mundo</p>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-lg font-semibold">MELANO INC</p>
                    <p class="text-purple-200">Versión {{ config.VERSION }}</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="py-20 bg-gradient-to-br from-purple-600 via-blue-600 to-teal-500 text-white">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-5xl font-bold mb-6">
                Conoce a <span class="alenya-gradient">ALENYA</span>
            </h2>
            <p class="text-xl mb-8 max-w-3xl mx-auto">
                Tu asistente IA especializada en <strong>inversiones automatizadas</strong>, 
                <strong>ventas premium</strong> y <strong>real estate inteligente</strong>. 
                Maximiza tu ROI con la tecnología más avanzada del mercado.
            </p>
            <div class="flex flex-wrap justify-center gap-4 mb-8">
                <span class="bg-white bg-opacity-20 px-4 py-2 rounded-full text-sm font-semibold glassmorphism">
                    🚀 Automatización IA
                </span>
                <span class="bg-white bg-opacity-20 px-4 py-2 rounded-full text-sm font-semibold glassmorphism">
                    💎 Ventas Premium
                </span>
                <span class="bg-white bg-opacity-20 px-4 py-2 rounded-full text-sm font-semibold glassmorphism">
                    🏢 Real Estate
                </span>
                <span class="bg-white bg-opacity-20 px-4 py-2 rounded-full text-sm font-semibold glassmorphism">
                    📊 ROI Maximizado
                </span>
            </div>
        </div>
    </section>

    <!-- Chat Interface -->
    <section class="py-16 bg-white">
        <div class="container mx-auto px-6">
            <div class="max-w-4xl mx-auto">
                <h3 class="text-3xl font-bold text-center mb-8 text-gray-800">
                    💬 Chatea con ALENYA Ahora
                </h3>
                
                <!-- Chat Configuration -->
                <div class="grid md:grid-cols-3 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">País</label>
                        <select id="pais" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <option value="Argentina">🇦🇷 Argentina</option>
                            <option value="España">🇪🇸 España</option>
                            <option value="México">🇲🇽 México</option>
                            <option value="Colombia">🇨🇴 Colombia</option>
                            <option value="Chile">🇨🇱 Chile</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Vertical</label>
                        <select id="vertical" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <option value="inversión">💰 Inversión</option>
                            <option value="ventas">🎯 Ventas</option>
                            <option value="real_estate">🏢 Real Estate</option>
                            <option value="automatización">🤖 Automatización</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Etapa</label>
                        <select id="etapa" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <option value="prospecto">🔍 Prospecto</option>
                            <option value="lead">📞 Lead</option>
                            <option value="cliente">💎 Cliente</option>
                        </select>
                    </div>
                </div>
                
                <!-- Chat Container -->
                <div class="bg-gray-100 rounded-xl shadow-xl">
                    <div id="chatContainer" class="chat-container p-6 overflow-y-auto rounded-t-xl">
                        <div class="message-alenya p-4 rounded-lg mb-4 max-w-xs">
                            <p class="font-semibold mb-2">ALENYA</p>
                            <p>¡Hola! Soy ALENYA, tu asistente IA especializada. ¿En qué puedo ayudarte hoy? 🚀</p>
                        </div>
                    </div>
                    
                    <!-- Chat Input -->
                    <div class="p-6 border-t border-gray-300 bg-white rounded-b-xl">
                        <div class="flex space-x-3">
                            <input 
                                type="text" 
                                id="messageInput" 
                                placeholder="Escribe tu mensaje aquí..." 
                                class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                onkeypress="if(event.key==='Enter') sendMessage()"
                            >
                            <button 
                                onclick="sendMessage()" 
                                id="sendButton"
                                class="px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:from-purple-700 hover:to-blue-700 transition-all duration-300 hover-scale"
                            >
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features -->
    <section class="py-16 bg-gray-100">
        <div class="container mx-auto px-6">
            <h3 class="text-3xl font-bold text-center mb-12 text-gray-800">
                🌟 Capacidades Únicas de ALENYA
            </h3>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-lg hover-scale">
                    <div class="text-4xl mb-4">🧠</div>
                    <h4 class="text-xl font-semibold mb-3">Inteligencia Emocional</h4>
                    <p class="text-gray-600">Detecta emociones y adapta respuestas para conexión profunda con cada prospecto.</p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg hover-scale">
                    <div class="text-4xl mb-4">🎯</div>
                    <h4 class="text-xl font-semibold mb-3">Scoring Avanzado</h4>
                    <p class="text-gray-600">Sistema de calificación de leads con precisión del 94% para optimizar conversiones.</p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg hover-scale">
                    <div class="text-4xl mb-4">🌎</div>
                    <h4 class="text-xl font-semibold mb-3">Personalización Regional</h4>
                    <p class="text-gray-600">Adaptación cultural y de mercado para 13 países de habla hispana.</p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg hover-scale">
                    <div class="text-4xl mb-4">📈</div>
                    <h4 class="text-xl font-semibold mb-3">ROI Predictivo</h4>
                    <p class="text-gray-600">Análisis predictivo con IA para maximizar retorno de inversión.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Stats -->
    <section class="py-16 gradient-bg text-white">
        <div class="container mx-auto px-6">
            <div class="grid md:grid-cols-4 gap-8 text-center">
                <div>
                    <div class="text-4xl font-bold mb-2">400%</div>
                    <p class="text-purple-200">Aumento en Conversiones</p>
                </div>
                <div>
                    <div class="text-4xl font-bold mb-2">94%</div>
                    <p class="text-purple-200">Precisión en Lead Scoring</p>
                </div>
                <div>
                    <div class="text-4xl font-bold mb-2">13</div>
                    <p class="text-purple-200">Países Soportados</p>
                </div>
                <div>
                    <div class="text-4xl font-bold mb-2">24/7</div>
                    <p class="text-purple-200">Disponibilidad</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Quick Examples -->
    <section class="py-16 bg-white">
        <div class="container mx-auto px-6">
            <h3 class="text-3xl font-bold text-center mb-12 text-gray-800">
                💡 Prueba Estos Ejemplos
            </h3>
            
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="bg-gradient-to-br from-green-400 to-blue-500 p-6 rounded-xl text-white cursor-pointer hover-scale" onclick="setExample('Quiero invertir 50k USD en crypto, ¿cuál es la mejor estrategia?')">
                    <div class="text-2xl mb-3">💰</div>
                    <h4 class="font-semibold mb-2">Inversión en Crypto</h4>
                    <p class="text-sm opacity-90">"Quiero invertir 50k USD en crypto, ¿cuál es la mejor estrategia?"</p>
                </div>
                
                <div class="bg-gradient-to-br from-purple-400 to-pink-500 p-6 rounded-xl text-white cursor-pointer hover-scale" onclick="setExample('Necesito aumentar mis ventas de consultoría high-ticket')">
                    <div class="text-2xl mb-3">🎯</div>
                    <h4 class="font-semibold mb-2">Ventas Premium</h4>
                    <p class="text-sm opacity-90">"Necesito aumentar mis ventas de consultoría high-ticket"</p>
                </div>
                
                <div class="bg-gradient-to-br from-orange-400 to-red-500 p-6 rounded-xl text-white cursor-pointer hover-scale" onclick="setExample('Busco propiedades de inversión en Buenos Aires con buen ROI')">
                    <div class="text-2xl mb-3">🏢</div>
                    <h4 class="font-semibold mb-2">Real Estate</h4>
                    <p class="text-sm opacity-90">"Busco propiedades de inversión en Buenos Aires con buen ROI"</p>
                </div>
                
                <div class="bg-gradient-to-br from-teal-400 to-cyan-500 p-6 rounded-xl text-white cursor-pointer hover-scale" onclick="setExample('Quiero automatizar mi proceso de ventas con IA')">
                    <div class="text-2xl mb-3">🤖</div>
                    <h4 class="font-semibold mb-2">Automatización</h4>
                    <p class="text-sm opacity-90">"Quiero automatizar mi proceso de ventas con IA"</p>
                </div>
                
                <div class="bg-gradient-to-br from-indigo-400 to-purple-500 p-6 rounded-xl text-white cursor-pointer hover-scale" onclick="setExample('Ayúdame a calificar mis leads automáticamente')">
                    <div class="text-2xl mb-3">📊</div>
                    <h4 class="font-semibold mb-2">Lead Scoring</h4>
                    <p class="text-sm opacity-90">"Ayúdame a calificar mis leads automáticamente"</p>
                </div>
                
                <div class="bg-gradient-to-br from-pink-400 to-rose-500 p-6 rounded-xl text-white cursor-pointer hover-scale" onclick="setExample('¿Cuál es el mejor momento para vender mi portfolio?')">
                    <div class="text-2xl mb-3">⏰</div>
                    <h4 class="font-semibold mb-2">Market Timing</h4>
                    <p class="text-sm opacity-90">"¿Cuál es el mejor momento para vender mi portfolio?"</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="container mx-auto px-6">
            <div class="text-center">
                <div class="flex items-center justify-center space-x-4 mb-6">
                    <div class="w-10 h-10 bg-purple-600 rounded-full flex items-center justify-center">
                        <i class="fas fa-robot text-lg"></i>
                    </div>
                    <div>
                        <h4 class="text-xl font-bold">ALENYA</h4>
                        <p class="text-gray-400">by MELANO INC</p>
                    </div>
                </div>
                
                <p class="text-gray-400 mb-6">
                    El agente IA más avanzado del mundo para inversiones, ventas y real estate.
                </p>
                
                <div class="border-t border-gray-700 pt-6">
                    <p class="text-gray-500 text-sm">
                        © {{ config.COMPANY }} {{ config.VERSION }} - Todos los derechos reservados.
                        Desde Mar del Plata al mundo entero 🚀
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Estado del chat
        let chatHistory = [];
        let messageCount = 0;

        // Configuración
        const API_BASE = '/api';

        // Función para enviar mensaje
        async function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            
            if (!message) return;
            
            // Limpiar input
            messageInput.value = '';
            messageCount++;
            
            // Agregar mensaje del usuario al chat
            addMessageToChat(message, 'user');
            
            // Mostrar indicador de carga
            showTypingIndicator();
            
            try {
                // Preparar datos
                const requestData = {
                    message: message,
                    pais: document.getElementById('pais').value,
                    vertical: document.getElementById('vertical').value,
                    etapa: document.getElementById('etapa').value,
                    contexto: {
                        numero_mensajes: messageCount,
                        timestamp: new Date().toISOString()
                    }
                };
                
                // Enviar request a ALENYA
                const response = await fetch(`${API_BASE}/chat`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });
                
                const data = await response.json();
                
                // Remover indicador de carga
                removeTypingIndicator();
                
                if (data.success) {
                    // Agregar respuesta de ALENYA
                    addMessageToChat(data.respuesta, 'alenya', data.metadata);
                    
                    // Guardar en historial
                    chatHistory.push({
                        user: message,
                        alenya: data.respuesta,
                        metadata: data.metadata,
                        timestamp: new Date().toISOString()
                    });
                    
                    // Mostrar score si es relevante
                    if (data.metadata && data.metadata.score_lead) {
                        showScoreInfo(data.metadata.score_lead);
                    }
                    
                } else {
                    addMessageToChat('❌ Error: ' + (data.error || 'Error desconocido'), 'error');
                }
                
            } catch (error) {
                removeTypingIndicator();
                addMessageToChat('❌ Error de conexión: ' + error.message, 'error');
                console.error('Error:', error);
            }
        }

        // Función para agregar mensaje al chat
        function addMessageToChat(message, sender, metadata = null) {
            const chatContainer = document.getElementById('chatContainer');
            const messageDiv = document.createElement('div');
            
            let senderName = '';
            let messageClass = '';
            let alignClass = '';
            
            switch(sender) {
                case 'user':
                    senderName = 'Tú';
                    messageClass = 'message-user ml-auto';
                    alignClass = 'justify-end';
                    break;
                case 'alenya':
                    senderName = 'ALENYA';
                    messageClass = 'message-alenya';
                    alignClass = 'justify-start';
                    break;
                case 'error':
                    senderName = 'Sistema';
                    messageClass = 'bg-red-500 text-white';
                    alignClass = 'justify-center';
                    break;
            }
            
            messageDiv.className = `flex ${alignClass} mb-4`;
            
            const messageContent = `
                <div class="${messageClass} p-4 rounded-lg max-w-md">
                    <p class="font-semibold mb-2">${senderName}</p>
                    <div class="message-content">${formatMessage(message)}</div>
                    ${metadata ? `<div class="text-xs opacity-75 mt-2">Score: ${metadata.score_lead?.score || 'N/A'}</div>` : ''}
                </div>
            `;
            
            messageDiv.innerHTML = messageContent;
            chatContainer.appendChild(messageDiv);
            
            // Scroll al final
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        // Función para formatear mensaje
        function formatMessage(message) {
            // Convertir markdown básico a HTML
            message = message.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            message = message.replace(/\*(.*?)\*/g, '<em>$1</em>');
            message = message.replace(/\n/g, '<br>');
            
            // Convertir emojis y bullets
            message = message.replace(/• /g, '• ');
            message = message.replace(/🎯 \*\*(.*?)\*\*/g, '🎯 <strong>$1</strong>');
            
            return message;
        }

        // Función para mostrar indicador de escritura
        function showTypingIndicator() {
            const chatContainer = document.getElementById('chatContainer');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typingIndicator';
            typingDiv.className = 'flex justify-start mb-4';
            typingDiv.innerHTML = `
                <div class="message-alenya p-4 rounded-lg max-w-xs">
                    <p class="font-semibold mb-2">ALENYA</p>
                    <div class="flex space-x-1">
                        <div class="w-2 h-2 bg-white rounded-full pulse-animation"></div>
                        <div class="w-2 h-2 bg-white rounded-full pulse-animation" style="animation-delay: 0.2s;"></div>
                        <div class="w-2 h-2 bg-white rounded-full pulse-animation" style="animation-delay: 0.4s;"></div>
                    </div>
                </div>
            `;
            chatContainer.appendChild(typingDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        // Función para remover indicador de escritura
        function removeTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            if (indicator) {
                indicator.remove();
            }
        }

        // Función para mostrar información de score
        function showScoreInfo(scoreData) {
            // Solo mostrar para scores altos
            if (scoreData.score >= 60) {
                setTimeout(() => {
                    const notification = document.createElement('div');
                    notification.className = 'fixed top-4 right-4 bg-green-500 text-white p-4 rounded-lg shadow-lg z-50';
                    notification.innerHTML = `
                        <div class="flex items-center space-x-2">
                            <i class="fas fa-star"></i>
                            <div>
                                <div class="font-semibold">${scoreData.clasificacion}</div>
                                <div class="text-sm">Score: ${scoreData.score}/100</div>
                            </div>
                        </div>
                    `;
                    document.body.appendChild(notification);
                    
                    // Remover después de 5 segundos
                    setTimeout(() => {
                        notification.remove();
                    }, 5000);
                }, 1000);
            }
        }

        // Función para establecer ejemplo
        function setExample(text) {
            document.getElementById('messageInput').value = text;
            document.getElementById('messageInput').focus();
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Focus en input al cargar
            document.getElementById('messageInput').focus();
            
            // Detectar Enter en input
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        });

        // Función para limpiar chat
        function clearChat() {
            const chatContainer = document.getElementById('chatContainer');
            chatContainer.innerHTML = `
                <div class="message-alenya p-4 rounded-lg mb-4 max-w-xs">
                    <p class="font-semibold mb-2">ALENYA</p>
                    <p>¡Hola! Soy ALENYA, tu asistente IA especializada. ¿En qué puedo ayudarte hoy? 🚀</p>
                </div>
            `;
            chatHistory = [];
            messageCount = 0;
        }

        // Función para exportar chat
        function exportChat() {
            if (chatHistory.length === 0) {
                alert('No hay conversación para exportar.');
                return;
            }
            
            const dataStr = JSON.stringify(chatHistory, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `alenya-chat-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }

        // Agregar botones de control (opcional)
        function addControlButtons() {
            const chatContainer = document.getElementById('chatContainer').parentElement;
            const controlsDiv = document.createElement('div');
            controlsDiv.className = 'flex justify-between items-center px-6 py-2 bg-gray-50 border-t';
            controlsDiv.innerHTML = `
                <button onclick="clearChat()" class="text-sm text-gray-500 hover:text-gray-700">
                    <i class="fas fa-trash"></i> Limpiar Chat
                </button>
                <button onclick="exportChat()" class="text-sm text-gray-500 hover:text-gray-700">
                    <i class="fas fa-download"></i> Exportar
                </button>
            `;
            chatContainer.appendChild(controlsDiv);
        }

        // Inicialización adicional
        document.addEventListener('DOMContentLoaded', function() {
            // addControlButtons(); // Descomenta si quieres botones de control
            
            console.log('🚀 ALENYA Chat Interface Initialized');
            console.log('Version:', '{{ config.VERSION }}');
            console.log('Company:', '{{ config.COMPANY }}');
        });
    </script>
</body>
</html>

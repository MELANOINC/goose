<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MELANO INC - Ecosistema de Agentes IA | Dashboard</title>
    <meta name="description" content="Dashboard completo del ecosistema de agentes IA de MELANO INC. Tecnologías cuánticas, análisis emocional y más.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <style>
        * { font-family: 'Inter', sans-serif; }
        
        .melano-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
        }
        
        .quantum-gradient {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .emotion-gradient {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }
        
        .oracle-gradient {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }
        
        .meta-gradient {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }
        
        .portfolio-gradient {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .status-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        .metric-value {
            font-size: 2.5rem;
            font-weight: 900;
            line-height: 1;
        }
        
        .tech-card {
            position: relative;
            overflow: hidden;
        }
        
        .tech-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .tech-card:hover::before {
            left: 100%;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .floating {
            animation: float 3s ease-in-out infinite;
        }
        
        .ai-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #10b981;
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="melano-gradient text-white shadow-2xl">
        <div class="container mx-auto px-6 py-8">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="floating">
                        <i class="fas fa-brain text-4xl"></i>
                    </div>
                    <div>
                        <h1 class="text-4xl font-black">MELANO INC</h1>
                        <p class="text-xl font-light opacity-90">Ecosistema de Agentes IA</p>
                    </div>
                </div>
                <div class="flex items-center space-x-6">
                    <div class="text-right">
                        <div class="text-sm opacity-75">Versión</div>
                        <div class="text-xl font-bold">{{ config.VERSION }}</div>
                    </div>
                    <div class="status-indicator"></div>
                    <span class="text-sm">OPERACIONAL</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Dashboard -->
    <main class="container mx-auto px-6 py-8">
        <!-- Métricas Principales -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">
                <i class="fas fa-chart-line mr-3 text-indigo-600"></i>
                Métricas de Innovación
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="metrics-grid">
                <!-- Métricas se llenarán dinámicamente -->
            </div>
        </section>

        <!-- Tecnologías Patentadas -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">
                <i class="fas fa-atom mr-3 text-purple-600"></i>
                Tecnologías Patentadas
            </h2>
            
            <div class="ai-grid" id="technologies-grid">
                <!-- Tecnologías se llenarán dinámicamente -->
            </div>
        </section>

        <!-- Panel de Control en Tiempo Real -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">
                <i class="fas fa-tachometer-alt mr-3 text-green-600"></i>
                Control en Tiempo Real
            </h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Gráfico de Performance -->
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-chart-area mr-2 text-blue-600"></i>
                        Performance de Agentes
                    </h3>
                    <canvas id="performanceChart" width="400" height="200"></canvas>
                </div>

                <!-- Log de Actividad -->
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-list mr-2 text-purple-600"></i>
                        Actividad Reciente
                    </h3>
                    <div id="activity-log" class="space-y-3 max-h-64 overflow-y-auto">
                        <!-- Log se llenará dinámicamente -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Panel de Pruebas -->
        <section class="mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">
                <i class="fas fa-flask mr-3 text-red-600"></i>
                Centro de Pruebas
            </h2>
            
            <div class="bg-white rounded-2xl shadow-xl p-8">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Prueba Rápida -->
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-4">
                            <i class="fas fa-bolt mr-2 text-yellow-600"></i>
                            Prueba Rápida de IA
                        </h3>
                        <div class="space-y-4">
                            <select id="tech-selector" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none">
                                <option value="">Selecciona una tecnología...</option>
                                <option value="neural-forecast">Quantum Neural Forecasting™</option>
                                <option value="emotion-ai">Emotional Intelligence AI™</option>
                                <option value="quantum-portfolio">Quantum Portfolio Optimizer™</option>
                                <option value="blockchain-oracle">Blockchain Oracle Intelligence™</option>
                                <option value="meta-learning">Meta-Learning Sales Optimizer™</option>
                            </select>
                            <button id="test-tech-btn" class="w-full melano-gradient text-white py-3 px-6 rounded-lg font-bold hover:opacity-90 transition-opacity">
                                <i class="fas fa-play mr-2"></i>
                                Ejecutar Prueba
                            </button>
                        </div>
                    </div>

                    <!-- Resultados -->
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-4">
                            <i class="fas fa-chart-bar mr-2 text-green-600"></i>
                            Resultados
                        </h3>
                        <div id="test-results" class="bg-gray-50 rounded-lg p-4 min-h-32 border-2 border-dashed border-gray-300">
                            <p class="text-gray-500 text-center">Selecciona una tecnología y ejecuta una prueba para ver los resultados aquí.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-8">
        <div class="container mx-auto px-6 text-center">
            <div class="flex items-center justify-center space-x-4 mb-4">
                <i class="fas fa-rocket text-2xl text-indigo-400"></i>
                <span class="text-2xl font-bold">MELANO INC</span>
                <i class="fas fa-rocket text-2xl text-indigo-400"></i>
            </div>
            <p class="text-gray-400">Mar del Plata → El Mundo</p>
            <p class="text-sm text-gray-500 mt-2">Redefiniendo lo posible, una innovación a la vez</p>
            <div class="mt-4 flex justify-center space-x-6">
                <a href="/" class="text-indigo-400 hover:text-indigo-300 transition-colors">
                    <i class="fas fa-home mr-2"></i>Chat ALENYA
                </a>
                <a href="/api/innovation-hub" class="text-indigo-400 hover:text-indigo-300 transition-colors">
                    <i class="fas fa-atom mr-2"></i>Innovation Hub
                </a>
                <a href="/api/health" class="text-indigo-400 hover:text-indigo-300 transition-colors">
                    <i class="fas fa-heartbeat mr-2"></i>System Health
                </a>
            </div>
        </div>
    </footer>

    <script>
        // Configuración global
        const API_BASE = '';
        
        // Datos de las tecnologías
        const technologies = {
            'neural-forecast': {
                name: 'Quantum Neural Forecasting™',
                patente: 'MELANO-2025-QNF-001',
                description: 'Primera IA comercial con redes neuronales cuánticas',
                precision: '97.3%',
                gradient: 'quantum-gradient',
                icon: 'fas fa-brain',
                endpoint: '/api/neural-forecast'
            },
            'emotion-ai': {
                name: 'Emotional Intelligence AI™',
                patente: 'MELANO-2025-EIA-002',
                description: 'Análisis emocional en 12 dimensiones',
                precision: '94.7%',
                gradient: 'emotion-gradient',
                icon: 'fas fa-heart',
                endpoint: '/api/emotion-ai'
            },
            'quantum-portfolio': {
                name: 'Quantum Portfolio Optimizer™',
                patente: 'MELANO-2025-QPO-003',
                description: 'Optimización cuántica de inversiones',
                precision: '+340% ROI',
                gradient: 'portfolio-gradient',
                icon: 'fas fa-chart-pie',
                endpoint: '/api/quantum-portfolio'
            },
            'blockchain-oracle': {
                name: 'Blockchain Oracle Intelligence™',
                patente: 'MELANO-2025-BOI-004',
                description: 'Oráculo más preciso del mercado',
                precision: '96.1%',
                gradient: 'oracle-gradient',
                icon: 'fab fa-bitcoin',
                endpoint: '/api/blockchain-oracle'
            },
            'meta-learning': {
                name: 'Meta-Learning Sales Optimizer™',
                patente: 'MELANO-2025-MLS-005',
                description: 'Sistema autoevolutivo de optimización',
                precision: '+450% ventas',
                gradient: 'meta-gradient',
                icon: 'fas fa-robot',
                endpoint: '/api/meta-learning'
            }
        };

        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            loadMetrics();
            loadTechnologies();
            initializeCharts();
            startActivityLog();
            initializeTestPanel();
        });

        // Cargar métricas principales
        async function loadMetrics() {
            try {
                const response = await fetch('/api/innovation-hub');
                const data = await response.json();
                
                const metrics = [
                    { label: 'Patentes 2025', value: '47', icon: 'fas fa-certificate', color: 'text-blue-600' },
                    { label: 'Tecnologías Activas', value: '12', icon: 'fas fa-cogs', color: 'text-green-600' },
                    { label: 'Modelos IA', value: '156', icon: 'fas fa-brain', color: 'text-purple-600' },
                    { label: 'Tasa de Éxito', value: '98.2%', icon: 'fas fa-trophy', color: 'text-yellow-600' }
                ];

                const metricsGrid = document.getElementById('metrics-grid');
                metricsGrid.innerHTML = metrics.map(metric => `
                    <div class="bg-white rounded-2xl shadow-xl p-6 card-hover animate__animated animate__fadeInUp">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-gray-600 text-sm font-medium">${metric.label}</p>
                                <p class="metric-value ${metric.color}">${metric.value}</p>
                            </div>
                            <div class="text-4xl ${metric.color} opacity-80">
                                <i class="${metric.icon}"></i>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('Error loading metrics:', error);
            }
        }

        // Cargar tecnologías
        function loadTechnologies() {
            const techGrid = document.getElementById('technologies-grid');
            techGrid.innerHTML = Object.entries(technologies).map(([key, tech]) => `
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden tech-card card-hover animate__animated animate__fadeInUp">
                    <div class="${tech.gradient} p-6 text-white">
                        <div class="flex items-center justify-between mb-4">
                            <i class="${tech.icon} text-3xl"></i>
                            <div class="status-indicator bg-green-400"></div>
                        </div>
                        <h3 class="text-xl font-bold mb-2">${tech.name}</h3>
                        <p class="text-sm opacity-90">${tech.patente}</p>
                    </div>
                    <div class="p-6">
                        <p class="text-gray-600 mb-4">${tech.description}</p>
                        <div class="flex justify-between items-center">
                            <span class="text-2xl font-bold text-green-600">${tech.precision}</span>
                            <button onclick="testTechnology('${key}')" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors">
                                <i class="fas fa-play mr-1"></i>Probar
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Inicializar gráficos
        function initializeCharts() {
            const ctx = document.getElementById('performanceChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00'],
                    datasets: [{
                        label: 'Performance IA',
                        data: [85, 92, 88, 95, 97, 94],
                        borderColor: 'rgb(99, 102, 241)',
                        backgroundColor: 'rgba(99, 102, 241, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        // Log de actividad
        function startActivityLog() {
            const activityLog = document.getElementById('activity-log');
            const activities = [
                'Quantum Neural Forecasting procesó 247 predicciones',
                'Emotional Intelligence AI analizó 89 conversaciones',
                'Meta-Learning evolucionó arquitectura neural',
                'Blockchain Oracle detectó oportunidad Bitcoin',
                'Portfolio Optimizer rebalanceó 12 carteras'
            ];

            let index = 0;
            function addActivity() {
                const time = new Date().toLocaleTimeString();
                const activity = activities[index % activities.length];
                
                const activityElement = document.createElement('div');
                activityElement.className = 'flex items-center space-x-3 p-3 bg-gray-50 rounded-lg animate__animated animate__fadeInRight';
                activityElement.innerHTML = `
                    <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                    <div class="flex-1">
                        <p class="text-sm font-medium text-gray-800">${activity}</p>
                        <p class="text-xs text-gray-500">${time}</p>
                    </div>
                `;
                
                activityLog.insertBefore(activityElement, activityLog.firstChild);
                
                // Mantener solo los últimos 5 elementos
                while (activityLog.children.length > 5) {
                    activityLog.removeChild(activityLog.lastChild);
                }
                
                index++;
            }

            // Agregar actividad inicial
            addActivity();
            
            // Agregar nueva actividad cada 5 segundos
            setInterval(addActivity, 5000);
        }

        // Panel de pruebas
        function initializeTestPanel() {
            const testBtn = document.getElementById('test-tech-btn');
            testBtn.addEventListener('click', function() {
                const selector = document.getElementById('tech-selector');
                const techKey = selector.value;
                
                if (techKey) {
                    testTechnology(techKey);
                } else {
                    alert('Por favor selecciona una tecnología para probar');
                }
            });
        }

        // Probar tecnología
        async function testTechnology(techKey) {
            const tech = technologies[techKey];
            const resultsDiv = document.getElementById('test-results');
            
            resultsDiv.innerHTML = `
                <div class="text-center">
                    <i class="fas fa-spinner fa-spin text-4xl text-indigo-600 mb-4"></i>
                    <p class="text-gray-600">Ejecutando ${tech.name}...</p>
                </div>
            `;

            try {
                // Preparar datos de prueba según la tecnología
                let testData = {};
                switch(techKey) {
                    case 'neural-forecast':
                        testData = { market: 'crypto', timeframe: '24h', risk_tolerance: 'medium' };
                        break;
                    case 'emotion-ai':
                        testData = { text: 'Estoy muy interesado en invertir en criptomonedas', context: 'sales' };
                        break;
                    case 'quantum-portfolio':
                        testData = { capital: 100000, risk_profile: 'aggressive', investment_horizon: '12m' };
                        break;
                    case 'blockchain-oracle':
                        testData = { blockchain: 'ethereum', prediction_type: 'price', timeframe: '24h' };
                        break;
                    case 'meta-learning':
                        testData = { sales_data: {}, optimization_goal: 'conversion' };
                        break;
                }

                const response = await fetch(tech.endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(testData)
                });

                const result = await response.json();
                
                if (result.success) {
                    resultsDiv.innerHTML = `
                        <div class="animate__animated animate__fadeIn">
                            <div class="flex items-center mb-4">
                                <i class="fas fa-check-circle text-green-600 text-2xl mr-3"></i>
                                <h4 class="text-lg font-bold text-gray-800">${tech.name}</h4>
                            </div>
                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                <p class="text-sm text-green-800 mb-2"><strong>Estado:</strong> ✅ Operacional</p>
                                <p class="text-sm text-green-800 mb-2"><strong>Patente:</strong> ${result.patente || tech.patente}</p>
                                <p class="text-sm text-green-800 mb-2"><strong>Precisión:</strong> ${result.precision || tech.precision}</p>
                                <p class="text-sm text-green-800"><strong>Timestamp:</strong> ${result.timestamp}</p>
                            </div>
                        </div>
                    `;
                } else {
                    throw new Error(result.error || 'Error desconocido');
                }
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div class="animate__animated animate__fadeIn">
                        <div class="flex items-center mb-4">
                            <i class="fas fa-exclamation-triangle text-red-600 text-2xl mr-3"></i>
                            <h4 class="text-lg font-bold text-gray-800">Error en la Prueba</h4>
                        </div>
                        <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                            <p class="text-sm text-red-800">${error.message}</p>
                        </div>
                    </div>
                `;
            }
        }

        // Actualizar estado en tiempo real
        setInterval(async function() {
            try {
                const response = await fetch('/api/health');
                const health = await response.json();
                
                const indicators = document.querySelectorAll('.status-indicator');
                indicators.forEach(indicator => {
                    indicator.style.background = health.success ? '#10b981' : '#ef4444';
                });
            } catch (error) {
                console.error('Error checking health:', error);
            }
        }, 10000);
    </script>
</body>
</html>

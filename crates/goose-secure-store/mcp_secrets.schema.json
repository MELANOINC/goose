{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "MCP Secrets Configuration Schema",
  "description": "Schema for validating the secrets array in MCP server configuration",
  "type": "array",
  "items": {
    "type": "object",
    "properties": {
      "name": {
        "type": "string",
        "description": "The environment variable name for the secret",
        "pattern": "^[A-Z][A-Z0-9_]*$"
      },
      "description": {
        "type": "string",
        "description": "Human-readable description of what this secret is used for"
      },
      "acquisition": {
        "type": "object",
        "description": "Configuration for how to acquire this secret",
        "properties": {
          "method": {
            "type": "string",
            "enum": ["prompt", "oauth2", "command"],
            "description": "The method to use for acquiring the secret"
          }
        },
        "required": ["method"],
        "allOf": [
          {
            "if": {
              "properties": {
                "method": {
                  "const": "prompt"
                }
              }
            },
            "then": {
              "properties": {
                "method": true,
                "prompt_message": {
                  "type": "string",
                  "description": "Custom message to display when prompting for the secret"
                }
              },
              "additionalProperties": false
            }
          },
          {
            "if": {
              "properties": {
                "method": {
                  "const": "oauth2"
                }
              }
            },
            "then": {
              "properties": {
                "method": true,
                "authorization_url": {
                  "type": "string",
                  "format": "uri",
                  "description": "OAuth2 authorization endpoint URL"
                },
                "token_url": {
                  "type": "string",
                  "format": "uri",
                  "description": "OAuth2 token endpoint URL"
                },
                "client_id": {
                  "type": "string",
                  "description": "OAuth2 client ID"
                },
                "scopes": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "List of OAuth2 scopes to request"
                },
                "refresh": {
                  "type": "boolean",
                  "default": true,
                  "description": "Whether to support token refresh"
                }
              },
              "required": ["authorization_url", "token_url", "client_id"],
              "additionalProperties": false
            }
          },
          {
            "if": {
              "properties": {
                "method": {
                  "const": "command"
                }
              }
            },
            "then": {
              "properties": {
                "method": true,
                "command": {
                  "type": "string",
                  "description": "Shell command to execute to retrieve the secret"
                }
              },
              "required": ["command"],
              "additionalProperties": false
            }
          }
        ]
      }
    },
    "required": ["name", "description", "acquisition"],
    "additionalProperties": false
  }
}
